!function(e){function t(i){if(n[i])return n[i].exports;var o=n[i]={exports:{},id:i,loaded:!1};return e[i].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="./",t(0)}([function(e,t,n){e.exports=n(14)},function(e,t){e.exports={Emitter:[{bulletOpts:{orignX:85,orignY:250,orignWidth:12,orignHeight:24},speed:-20,number:1,limit:1,spacing:-100,timeout:100,propulsiontype:"line",type:"circle"},{bulletOpts:{orignX:3,orignY:250,orignWidth:18,orignHeight:23},speed:3,number:50,limit:10,spacing:15,timeout:500,propulsiontype:"circle",type:"circle"},{bulletOpts:{orignX:26,orignY:250,orignWidth:22,orignHeight:22},speed:5,number:30,limit:10,spacing:30,timeout:1e3,propulsiontype:"crosspow",type:"circle"},{bulletOpts:{orignX:50,orignY:250,orignWidth:25,orignHeight:25},speed:15,number:35,limit:10,spacing:50,timeout:1e3,propulsiontype:"test",type:"circle"},{bulletOpts:{orignX:85,orignY:250,orignWidth:12,orignHeight:24},speed:1,number:35,limit:10,spacing:10,timeout:500,propulsiontype:"circle",type:"circle"},{bulletOpts:{orignX:110,orignY:250,orignWidth:10,orignHeight:20},speed:15,number:25,limit:10,spacing:50,timeout:1e3,propulsiontype:"crosspow",type:"circle"},{bulletOpts:{orignX:6,orignY:280,orignWidth:10,orignHeight:22},speed:10,number:30,limit:8,spacing:30,timeout:1e3,propulsiontype:"crosspow",type:"circle"},{bulletOpts:{orignX:32,orignY:280,orignWidth:10,orignHeight:22},speed:15,number:30,limit:10,spacing:50,timeout:500,propulsiontype:"circle",type:"circle"},{bulletOpts:{orignX:54,orignY:280,orignWidth:20,orignHeight:22},speed:10,number:30,limit:10,spacing:50,timeout:1e3,propulsiontype:"test",type:"circle"}],Explosion:[{orignX:0,orignY:0,orignWidth:62,orignHeight:62}],Enemy:[{orignX:150,orignY:0,orignWidth:150,orignHeight:250,HP:50},{orignX:300,orignY:0,orignWidth:150,orignHeight:250,HP:150},{orignX:0,orignY:0,orignWidth:150,orignHeight:250,HP:300}],Player:[{orignX:410,orignY:250,orignWidth:30,orignHeight:55,HP:10}],Magic:[{orignX:0,orignY:310,orignWidth:150,orignHeight:150},{orignX:150,orignY:310,orignWidth:150,orignHeight:150},{orignX:300,orignY:310,orignWidth:150,orignHeight:150},{orignX:0,orignY:460,orignWidth:150,orignHeight:150},{orignX:150,orignY:460,orignWidth:150,orignHeight:150},{orignX:300,orignY:460,orignWidth:150,orignHeight:150},{orignX:0,orignY:610,orignWidth:150,orignHeight:150},{orignX:150,orignY:610,orignWidth:150,orignHeight:150},{orignX:300,orignY:610,orignWidth:150,orignHeight:150},{orignX:0,orignY:760,orignWidth:150,orignHeight:150},{orignX:150,orignY:760,orignWidth:150,orignHeight:150},{orignX:300,orignY:760,orignWidth:150,orignHeight:150}]}},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(t,i,o,r){n(this,e),Object.assign(this,{x:t,y:i,cx:t+o/2,cy:i+r/2,width:o,height:r,halfWidth:o/2,halfHeight:r/2})}return i(e,[{key:"move",value:function(e,t){this.x=e-this.halfWidth,this.y=t-this.halfHeight,this.cx=e,this.cy=t}},{key:"resize",value:function(e){this.width*=e,this.height*=e,this.halfWidth*=e,this.halfHeight*=e}},{key:"carve",value:function(t){var n=[],i=[],o=t.cx,r=t.cy,a=o-this.x,s=r-this.y,u=a>0&&a<this.width,c=s>0&&s<this.height;if(u&&c)for(i=this.carve(o,this.y);i.length;)n=n.concat(i.shift().carve(this.x,r));else u?n.push(new e(this.x,this.y,a,this.height),new e(o,this.y,this.width-a,this.height)):c&&n.push(new e(this.x,this.y,this.width,s),new e(this.x,r,this.width,this.height-s));return n}}]),e}();t["default"]=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(2),c=i(u),l=n(18),h=i(l),f=n(1),d=i(f),g=function(e){function t(e,n,i,a){o(this,t);var s=r(this,Object.getPrototypeOf(t).call(this,n-a.orignWidth/2,i-a.orignHeight/2,a.orignWidth,a.orignHeight));return Object.assign(s,{img:e,orignX:a.orignX,orignY:a.orignY,orignWidth:a.orignWidth,orignHeight:a.orignHeight,mapX:a.orignX,mapY:a.orignY,mapWidth:a.orignWidth,mapHeight:a.orignHeight,angle:0,removed:!1,undead:!1}),s}return a(t,e),s(t,[{key:"draw",value:function(e){var t=Math.atan(this.cy/this.cx),n=this.cy/Math.sin(t),i=n*Math.sin(this.angle+t),o=i-this.cy,r=i/Math.tan(this.angle+t)-this.cx;e.save(),e.rotate(-this.angle),e.translate(r,o),e.drawImage(this.img,this.orignX,this.orignY,this.orignWidth,this.orignHeight,this.cx-this.mapWidth/2,this.cy-this.mapHeight/2,this.mapWidth,this.mapHeight),e.restore()}},{key:"change",value:function(e){this.orignX=Math.round(e*this.orignWidth)}},{key:"rotate",value:function(e){this.angle=e}},{key:"remap",value:function(e){this.mapWidth*=e,this.mapHeight*=e}},{key:"name",value:function(e){this.name=e}},{key:"go",value:function(){}},{key:"destroy",value:function(e,n){var i=new t(e,this.cx,this.cy,d["default"].Explosion[0]);i.undead=!0,(0,h["default"])(i,0,15,75,n),this.removed=!0}}]),t}(c["default"]);t["default"]=g},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=i(u),l=n(6),h=i(l),f=function(e){function t(e,n,i,a){o(this,t);var s=r(this,Object.getPrototypeOf(t).call(this,e,n,i,a));return s.bulletOpts={orignX:36,orignY:64,orignWidth:6,orignHeight:14},s.speed=20,s.number=15,s.limit=5,s.dist=0,s.spacing=100,s.timeout=500,s.propulsiontype="line",s.type="circle",s.fireTimes=0,s.fireSwitch=!0,s.init(a),s}return a(t,e),s(t,[{key:"init",value:function(e){Object.assign(this,e)}},{key:"circle",value:function(e){for(var t=void 0,n=void 0,i=0;i<this.number;++i)t=2*Math.PI*i/this.number,n=new h["default"](this.img,this.cx,this.cy,this.bulletOpts),n.set(t,this.speed,this.propulsiontype),e.insert(n)}},{key:"fire",value:function(e,t){var n=this;return this.fireSwitch?this.dist<this.spacing?this.dist+=this.speed:(this.dist=0,this.fireTimes>this.limit?(this.fireTimes=0,this.ceasefire(),this.onCeasefire(),setTimeout(function(){n.fireSwitch=!0},this.timeout)):(this.fireTimes++,void this[this.type](e))):this.onCeasefireInterval()}},{key:"ceasefire",value:function(){this.fireSwitch=!1}},{key:"onCeasefireInterval",value:function(){}},{key:"onCeasefire",value:function(){}}]),t}(c["default"]);t["default"]=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=i(u),l=function(e){function t(e,n,i,a){return o(this,t),r(this,Object.getPrototypeOf(t).call(this,e,n,i,a))}return a(t,e),s(t,[{key:"init",value:function(e){Object.assign(this,e)}},{key:"go",value:function(){this.angle+=Math.PI/72}}]),t}(c["default"]);t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),u=n(3),c=i(u),l=function(e){function t(e,n,i,a){o(this,t);var s=r(this,Object.getPrototypeOf(t).call(this,e,n,i,a));return Object.assign(s,{angle:0,dist:0,propulsiontype:null}),s}return a(t,e),s(t,[{key:"set",value:function(e,t,n){this.angle=e,this.dist=t,this.propulsiontype=n}},{key:"go",value:function(){this[this.propulsiontype](this.angle,this.dist)}},{key:"_motion",value:function(e,t){this.cx+=e,this.cy+=t,this.x+=e,this.y+=t}},{key:"_gravity",value:function(){this.cy+=5,this.y+=5}},{key:"line",value:function(e,t){this._motion(e,t)}},{key:"circle",value:function(e,t){var n=Math.round(Math.sin(e)*t),i=Math.round(Math.cos(e)*t);this._motion(n,i)}},{key:"crosspow",value:function(e,t){var n=Math.round(Math.sin(e)*t),i=Math.round(Math.pow(Math.sqrt(t),1.5));this._motion(n,i)}},{key:"test",value:function(e,t){var n=this.cx+Math.round(Math.sin(e)*t),i=Math.round(Math.pow(this.cy+1,1.002));this.move(n,i)}}]),t}(c["default"]);t["default"]=l},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function s(e,t){return Math.floor(Math.random()*(t-e)+e)}Object.defineProperty(t,"__esModule",{value:!0});var u=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),c=function m(e,t,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:m(o,t,n)}if("value"in i)return i.value;var r=i.get;if(void 0!==r)return r.call(n)},l=n(5),h=i(l),f=n(4),d=i(f),g=n(1),p=i(g),y=function(e){function t(e,n,i,a){o(this,t);var u=r(this,Object.getPrototypeOf(t).call(this,e,n,i,a));return u.HP=0,c(Object.getPrototypeOf(t.prototype),"remap",u).call(u,.5),c(Object.getPrototypeOf(t.prototype),"resize",u).call(u,.25),u.magic=null,u.HP=a.HP,u.init(p["default"].Emitter[1]),u.onCeasefire=function(){u.init(p["default"].Emitter[s(1,p["default"].Emitter.length)]),u.magic&&u.magic.init(p["default"].Magic[s(0,p["default"].Magic.length)])},u}return a(t,e),u(t,[{key:"setEmitter",value:function(e){if(e.constructor!=d["default"])throw new Error("入餐必须为EmitterSprite实例");this.emitter=e}},{key:"setMagic",value:function(e){if(e.constructor!=h["default"])throw new Error("入餐必须为MagicSprite实例");this.magic=e}}]),t}(d["default"]);t["default"]=y},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function d(e,t,n){null===e&&(e=Function.prototype);var i=Object.getOwnPropertyDescriptor(e,t);if(void 0===i){var o=Object.getPrototypeOf(e);return null===o?void 0:d(o,t,n)}if("value"in i)return i.value;var r=i.get;if(void 0!==r)return r.call(n)},u=n(4),c=i(u),l=n(1),h=i(l),f=function(e){function t(e,n,i,a){o(this,t);var u=r(this,Object.getPrototypeOf(t).call(this,e,n,i,a));return u.HP=0,s(Object.getPrototypeOf(t.prototype),"resize",u).call(u,.1),u.HP=a.HP,u.init(h["default"].Emitter[0]),u}return a(t,e),t}(c["default"]);t["default"]=f},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){return e.x+e.width>=t.x&&e.y+e.height>=t.y&&e.x-e.width<=t.x+t.width&&e.y-e.height<=t.y+t.height}Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),s=n(2),u=i(s),c=function(){function e(t,n){o(this,e),this.objects=[],this.nodes=[],this.level="undefined"==typeof n?0:n,this.bounds=t}return a(e,[{key:"clear",value:function(){var e=this.nodes,t=void 0;for(this.objects.splice(0,this.objects.length);e.length;)t=e.shift(),t.clear()}},{key:"getIndex",value:function(e){var t=this.bounds,n=e.y+e.height<=t.cy,i=e.y>=t.cy,o=e.x+e.width<=t.cx,r=e.x>=t.cx;if(n){if(r)return 0;if(o)return 1}else if(i){if(o)return 2;if(r)return 3}return-1}},{key:"split",value:function(){var t=this.level,n=this.bounds,i=n.x,o=n.y,r=n.cx,a=n.cy,s=n.width/2,c=n.height/2;this.nodes.push(new e(new u["default"](r,o,s,c),t+1),new e(new u["default"](i,o,s,c),t+1),new e(new u["default"](i,a,s,c),t+1),new e(new u["default"](r,a,s,c),t+1))}},{key:"insert",value:function(t){var n=this.objects,i=void 0,o=void 0;if(this.nodes.length&&(o=this.getIndex(t),o!==-1))return void this.nodes[o].insert(t);if(n.push(t),!this.nodes.length&&this.objects.length>e.MAX_OBJECTS&&this.level<e.MAX_LEVELS)for(this.split(),i=n.length-1;i>=0;i--)o=this.getIndex(n[i]),o!==-1&&this.nodes[o].insert(n.splice(i,1)[0])}},{key:"retrieve",value:function(e){var t=[],n=void 0,i=void 0,o=void 0;if(this.nodes.length)if(o=this.getIndex(e),o!==-1)t=t.concat(this.nodes[o].retrieve(e));else for(n=e.carve(this.bounds),i=n.length-1;i>=0&&(o=this.getIndex(n[i]),o!==-1);i--)t=t.concat(this.nodes[o].retrieve(e));return t=t.concat(this.objects)}},{key:"refresh",value:function(e){var t=this.objects,n=[],i=void 0,o=void 0,a=void 0,s=void 0;for(e=e||this,a=t.length-1;a>=0;a--)i=t[a],!i.removed&&r(i,e.bounds)?(o=this.getIndex(i),o!==-1&&r(i,this.bounds)?this.nodes.length&&this.nodes[o].insert(t.splice(a,1)[0]):this!==e&&e.insert(t.splice(a,1)[0])):this.objects.splice(a,1);for(a=0,s=this.nodes.length;a<s;a++)n=n.concat(this.nodes[a].refresh(e));return n=n.concat(t)}}]),e}();c.MAX_OBJECTS=10,c.MAX_LEVELS=5,t["default"]=c},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function o(){n(this,o),this.check={cube:function(e,t){return Math.abs(e.cx-t.cx)<(e.width+t.width)/2&&Math.abs(e.cy-t.cy)<(e.height+t.height)/2},circle:function(e,t){var n=Math.sqrt(Math.pow(Math.abs(e.cx-t.cx),2)+Math.pow(Math.abs(e.cy-t.cy),2)),i=Math.sqrt(Math.pow((e.width+t.width)/2,2)+Math.pow((e.height+t.height)/2,2));return n<i}}};t["default"]=i},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){n(this,e),this.startPos={x:0,y:0},this.movePos={x:0,y:0},this.eventTypeList=[],this.callbackList=[],this.event={tap:function(e,t,n){Math.abs(t.movePos.x-t.startPos.x)>1||Math.abs(t.movePos.y-t.startPos.y)>1||e(n)},swipe:function(e,t,n){return e(n),t.movePos={x:0,y:0}}}}return i(e,[{key:"addHandler",value:function(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent?e.attachEvent("on"+t,n):e["on"+t]=n}},{key:"init",value:function(e){var t=this;e=e||document;var n="ontouchstart"in document?"touchstart":"mousedown",i="ontouchmove"in document?"touchmove":"mousemove",o="ontouchend"in document?"touchend":"mouseup",r=function(e){e=e||window.event;var n="ontouchstart"in document?e.touches[0]:e;t.startPos={x:n.pageX,y:n.pageY},t.movePos=t.startPos},a=function(e){e=e||window.event;var n="ontouchstart"in document?e.touches[0]:e;t.movePos={x:n.pageX,y:n.pageY},e.preventDefault()},s=function(e){e=e||event,t.eventTypeList.forEach(function(n,i){t.event[n](t.callbackList[i].cb,t,e)})};this.addHandler(e,n,r),this.addHandler(e,i,a),this.addHandler(e,o,s)}},{key:"on",value:function(e,t){return this.eventTypeList.push(e),this.callbackList.push({cb:t}),this}}]),e}();t["default"]=o},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){n(this,e),this.layer=null,this.loaded=!0,this.loadedCount=0,this.totalCount=0,this.soundFileExtn=".ogg"}return i(e,[{key:"init",value:function(e){var t=void 0,n=void 0,i=document.createElement("audio");i.canPlayType?(t=""!=i.canPlayType("audio/mpeg"),n=""!=i.canPlayType('audio/ogg; codecs = "vorbis"')):(t=!1,n=!1),this.soundFileExtn=n?".ogg":t?".mp3":void 0,this.layer=e}},{key:"onload",value:function(){}},{key:"itemLoaded",value:function(){this.loadedCount++,this.loadedCount===this.totalCount&&(this.loaded=!0,this.layer.style.display="none",this.onload&&(this.onload(),this.onload=void 0))}},{key:"loadImage",value:function(e){var t=this;this.totalCount++,this.loaded=!1,this.layer.style.display="block";var n=new Image;return n.src=e,n.onload=function(){return t.itemLoaded()},n}},{key:"loadSound",value:function(e){this.totalCount++,this.loaded=!1,this.layer.style.display="block";var t=new Audio;return t.src=e+this.soundFileExtn,t.addEventListener("canplaythrough",this.itemLoaded,!1),t}}]),e}();t["default"]=o},function(e,t){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),o=function(){function e(){n(this,e),this.canvas=null,this.ctx=null,this.renderWidth=0,this.renderHeight=0,this.queue=[]}return i(e,[{key:"init",value:function(e){this.canvas=e,this.ctx=e.getContext("2d"),this.renderWidth=e.width,this.renderHeight=e.height}},{key:"add",value:function(e){this.queue=this.queue.concat(e)}},{key:"empty",value:function(){this.queue=[]}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.renderWidth,this.renderHeight)}},{key:"render",value:function(){var e=this;this.queue.forEach(function(t){t.go(),t.draw(e.ctx)})}}]),e}();t["default"]=o},function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}var o=n(10),r=i(o),a=n(11),s=i(a),u=n(12),c=i(u),l=n(13),h=i(l),f=n(7),d=i(f),g=n(8),p=i(g),y=n(5),m=i(y),v=n(9),b=i(v),w=n(2),O=i(w);n(19),n(20);var P=n(16),x=i(P),H=n(1),_=i(H),j={Collision:new r["default"],Render:new h["default"],Loader:new c["default"],Control:new s["default"],Resource:{images:{},sounds:{}},Setting:null,Dom:{scorelayer:document.getElementById("score-layer"),menulayer:document.getElementById("menu-layer"),resetlayer:document.getElementById("reset-layer"),loadlayer:document.getElementById("load-layer"),bglayer:document.getElementById("bg-layer"),canvas:document.getElementById("draw-target"),bgcanvas:document.getElementById("bg-target"),playerHP:document.getElementById("player-hp"),enemyHP:document.getElementById("enemy-hp"),score:document.getElementById("score")}},E={RAF:null,start:function(){var e=this,t=j.Render,n=j.Control,i=j.Resource,o=j.Dom,r=j.Loader;o.canvas.width=document.documentElement.clientWidth,o.canvas.height=document.documentElement.clientHeight,o.canvas.backgroundAlpha=0,o.bgcanvas.width=document.documentElement.clientWidth,o.bgcanvas.height=document.documentElement.clientHeight,t.init(o.canvas),n.init(document),r.init(o.loadlayer),i.images.all=r.loadImage(x["default"].images.ALL),i.images.explosion=r.loadImage(x["default"].images.EXPLOSION),i.images.bgs=[];for(var a=0,s=x["default"].images.BGs.length;a<s;a++)i.images.bgs[a]=r.loadImage(x["default"].images.BGs[a]);r.onload=function(){return e.play()}},play:function(){function e(){this.move(this.cx+v,this.cy),this.cx<10?v=1:this.cx>a.canvas.width-10&&(v=-1)}var t=this,n=j.Collision,i=j.Render,o=j.Control,r=j.Resource,a=j.Dom,s=0,u=a.bgcanvas.getContext("2d");u.drawImage(r.images.bgs[s],0,0,a.bgcanvas.width,a.bgcanvas.height);var c=new d["default"](r.images.all,i.renderWidth/2,i.renderHeight/5,_["default"].Enemy[s]),l=new p["default"](r.images.all,i.renderWidth/2,i.renderHeight,_["default"].Player[0]),h=new m["default"](r.images.all,c.cx,c.cy,_["default"].Magic[0]);c.setMagic(h);var f=new O["default"](0,0,a.canvas.width,a.canvas.height),g=new b["default"](f),y=new b["default"](f);y.insert(c.magic);var v=1;c.onCeasefireInterval=e;var w=r.images.explosion,P=[],x=[],H=a.enemyHP.offsetWidth,E=a.playerHP.offsetWidth;M.init();var k=function W(){t.RAF=window.requestAnimationFrame(W),c.fire(y),c.magic.move(c.cx,c.cy),l.fire(g,"player"),l.move(o.movePos.x,o.movePos.y),y.retrieve(l).forEach(function(e){e.removed||e.undead||!n.check.circle(l,e)||(e.destroy(w,y),l.HP--,a.playerHP.style.width=l.HP/_["default"].Player[0].HP*E+"px",l.HP<=0&&(l.destroy(w,y),l.ceasefire(),setTimeout(function(){a.resetlayer.style.display="block",window.cancelAnimationFrame(t.RAF)},1e3)))}),g.retrieve(c).forEach(function(o){o.removed||o.undead||!n.check.circle(c,o)||(o.destroy(w,y),c.HP--,a.score.innerHTML=parseInt(a.score.innerHTML)+100,a.enemyHP.style.width=c.HP/_["default"].Enemy[s].HP*H+"px",c.HP<=0&&(c.destroy(w,y),c.ceasefire(),++s>2&&setTimeout(function(){a.resetlayer.style.display="block",window.cancelAnimationFrame(t.RAF)},1e3),y.clear(),c=new d["default"](r.images.all,i.renderWidth/2,i.renderHeight/5,_["default"].Enemy[s]),c.onCeasefireInterval=e,c.setMagic(h),y.insert(h),j.Dom.enemyHP.style.width="80%",u.drawImage(r.images.bgs[s],0,0,a.bgcanvas.width,a.bgcanvas.height)))}),P=y.refresh(),x=g.refresh(),window.playerArr=x,i.add(P),i.add(x),i.add(c),i.add(l),i.clear(),i.render(),i.empty(),M.show()};this.RAF=window.requestAnimationFrame(k),o.on("tap",function(e){e=e||window.event;var n=e.srcElement||e.target;"reset"==n.id&&t.reset()})},reset:function(){window.cancelAnimationFrame(this.RAF),j.Render.clear(),j.Render.empty(),j.Dom.score.innerHTML="0",j.Dom.resetlayer.style.display="none",j.Dom.playerHP.style.width="80%",j.Dom.enemyHP.style.width="80%",this.play()},end:function(){}},M={layer:null,startTime:null,endTime:null,frame:0,init:function(){this.startTime=+new Date,this.layer=document.getElementById("fps")},show:function(){this.endTime=+new Date,this.frame=Math.round(1e3/(this.endTime-this.startTime)),this.startTime=this.endTime,this.layer.innerHTML=this.frame}};E.start()},,function(e,t,n){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=n(22),r=i(o),a=n(26),s=i(a),u=n(23),c=i(u),l=n(24),h=i(l),f=n(25),d=i(f);t["default"]={images:{ALL:r["default"],EXPLOSION:s["default"],BGs:[c["default"],h["default"],d["default"]]},sounds:[]}},,function(e,t){"use strict";function n(e,t,n,i,o){var r=void 0;!function a(){return t>=n?(e.removed=!0,e.undead=!1,void clearTimeout(r)):(e.change(++t),o.insert(e),void(r=setTimeout(a,i)))}()}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n},function(e,t){"use strict";for(var n=0,i=["ms","moz","webkit","o"],o=0;o<i.length&&!window.requestAnimationFrame;++o)window.requestAnimationFrame=window[i[o]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[o]+"CancelAnimationFrame"]||window[i[o]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e){var t=(new Date).getTime(),i=Math.max(0,16-(t-n)),o=window.setTimeout(function(){e(t+i)},i);return n=t+i,o}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})},function(e,t){},,function(e,t,n){e.exports=n.p+"images/all.png"},function(e,t,n){e.exports=n.p+"images/bg_blue.jpg"},function(e,t,n){e.exports=n.p+"images/bg_green.png"},function(e,t,n){e.exports=n.p+"images/bg_red.jpg"},function(e,t,n){e.exports=n.p+"images/explosion.png"}]);